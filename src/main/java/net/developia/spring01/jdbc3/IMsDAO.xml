<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.developia.spring01.jdbc3.IMsDAO">

	<select id="listDept" parameterType="int" resultType="DeptDTO">
		SELECT
		    deptno,
		    dname,
		    loc 
		FROM 
		    dept 
		WHERE 
		    deptno BETWEEN #{begin} AND #{end} 
		ORDER BY deptno ASC 
	</select>
		
	<insert id="insertDept" parameterType="DeptDTO" >
		INSERT INTO dept ( 
		    deptno, 
		    dname, 
		    loc 
		) VALUES ( 
		    #{deptno}, 
		    #{dname}, 
		    #{loc}
		) 
	</insert>
	
	<delete id="deleteDept" parameterType="Integer">
		delete dept
		where  deptno=#{deptno}
	</delete>
	
	<select id="countDept" resultType="int">
	<![CDATA[
		select count(*) from dept
	]]>
	</select>
	
	<select id="listEmployees" parameterType="int" resultType="EmployeesDTO">
	<![CDATA[
		SELECT 
		    e.employee_id, 
		    e.last_name, 
		    e.salary, 
		    e.job_id, 
		    e.department_id, 
		    d.department_name 
		FROM 
		         employees e 
		    INNER JOIN departments d ON e.department_id = d.department_id 
		           AND d.department_id <= #{deptno} 
	]]>
	</select>
</mapper>